<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body id="i713958" class="topic concept" lang="en_US"><div class="breadcrumbs"><div><div><a href="">ThunderBird StormCluster System</a></div><div><a href="contents/topics/c-about-defining-payload">Payload definition</a></div></div></div><h1 class="title">Payload definition</h1><p class="shortdesc">Layers of a captured packet are accessible when using payload options.</p><p class="p">The payload option allows you to select specific layers of the captured packet. The payload is defined by setting the appropriate control parameters.</p><p class="p">The payload layers are:</p><div class="p"><dl class="dl parml"><div class="dlentry plentry"><dt class="dt pt">Ether</dt><dd class="dd pd"><p class="p"></p><div class="p"><div class="table-headcount-0"><div><div><p class="p">Original L2</p></div><div><p class="p">(Outer IP or Tunnel header)</p></div><div><p class="p">Original L3 IP</p></div><div><p class="p">Original L4-L7</p></div></div></div></div><p class="p"></p><p class="p">The entire packet is processed, including the entire ethernet header.</p></dd></div><div class="dlentry plentry"><dt class="dt pt">IP</dt><dd class="dd pd"><p class="p">The ethernet headers are stripped and the rest of the packet is processed.</p></dd></div><div class="dlentry plentry"><dt class="dt pt">layer 4</dt><dd class="dd pd"><p class="p">Encapsulation is stripped down to the public IP headers, which is processed along with the rest of the packet.</p><p class="p"></p><div class="p"><div class="table-headcount-0"><div><div><p class="p"></p></div><div><p class="p"></p></div><div><p class="p">Original L3 IP</p></div><div><p class="p">Original L4-L7</p></div></div></div></div><p class="p"></p></dd></div><div class="dlentry plentry"><dt class="dt pt">original payload</dt><dd class="dd pd"><p class="p">IP header is stripped and the rest of the packet (layers 4 through 7) are processed.</p><p class="p"></p><div class="p"><div class="table-headcount-0"><div><div><p class="p"></p></div><div><p class="p"></p></div><div><p class="p"></p></div><div><p class="p">Original L4-L7</p></div></div></div></div><p class="p"></p></dd></div></dl></div><p class="p"></p><h2 class="title">IP header</h2><p class="p">An IP address routes traffic to the IP of the next node. Enter the destination IP address. This is used to obtain the Ethernet address.</p><div id="i713917" class="section"><h2 class="title">IP4 header</h2><p class="p">The IP4 header options are:</p><div class="p"><div class="table-headcount-1"><div><div>Parameter</div><div>Description</div></div><div><div><p class="p">Destination IP</p></div><div><p class="p">Destination IP address</p></div></div><div><div><p class="p">Source IP</p></div><div><p class="p">Source IP address. If omitted, the IP of the outgoing interface is used.</p></div></div><div><div><p class="p">TOS</p></div><div><p class="p">Marking for the processed packet</p></div></div><div><div><p class="p">TTL</p></div><div><p class="p">Use to assign a time to live value to the processed packet. This value is measured in milliseconds.</p></div></div></div></div><p class="p"></p></div><div id="i713923" class="section"><h2 class="title">UDP header</h2><p class="p">The UDP header options are:</p><div class="p"><div class="table-headcount-1"><div><div>Parameter</div><div>Description</div></div><div><div><p class="p">Destination port</p></div><div><p class="p">Layer 4 destination port</p></div></div><div><div><p class="p">Source port</p></div><div><p class="p">Layer 4 source port</p></div></div></div></div><p class="p"></p></div><div id="i713929" class="section"><h2 class="title">Binary header</h2><p class="p">The binary header takes a format string in TCL binary format.</p><p class="p">There are three fields parameters: Specified, Timestamp and subscriber.id.</p><div class="p"><dl class="dl parml"><div class="dlentry plentry"><dt class="dt pt">Specified</dt><dd class="dd pd"><p class="p">Requires an expression</p></dd></div><div class="dlentry plentry"><dt class="dt pt">Timestamp</dt><dd class="dd pd"><p class="p">Time the packet arrived</p></dd></div><div class="dlentry plentry"><dt class="dt pt">subscriber.id</dt><dd class="dd pd"><p class="p">Subscriber of the flow</p></dd></div></dl></div><p class="p"></p></div></body></html>