<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="../../_rhdefault.css"/></head><body id="v3248232" class="topic concept" lang="en_US"><div class="breadcrumbs"><div><div><a href="">ThunderBird StormCluster System</a></div><div><a href="contents/topics/c-cluster-reselection">Cluster reselection rules</a></div></div></div><h1 class="title">Cluster reselection rules</h1><div class="shortdesc">Set rules on when jobs are forwarded to clusters that have available resources.</div><div class="p">Jobs are forwarded to the execution cluster based on swp, mem, type, ncpu, model, boolean resources, cpu factors, and user-defined shared resource requirements. In some cases, however, jobs may reach the execution cluster and find other required resources are not available. The cluster reselection policy sets the length of time jobs pend, and allows returned jobs to be forwarded to other execution clusters that may have different resources available.</div><div class="p">Intelligence is built into execution clusters so that in the event that required resources are no longer available on a given execution cluster, the job will be automatically forwarded to an execution cluster that does have the required resources.</div><div class="p">The time forwarded jobs spend in being forwarded between execution clusters before returning to the submission cluster for rescheduling can be configured for each queue.</div><div class="p">The wait time before the same job is returned to the same execution cluster can also be set. Both values are defined in <span class="keyword parmname display-inline">MAX_RSCHED_TIME</span> in <span class="ph filepath display-inline">host.queues</span> and are multiplied by <span class="keyword parmname display-inline">MBD_SLEEP_TIME</span> (<span class="ph filepath display-inline">host.params</span>):</div><div class="p"><span class="ph userinput display-inline">MAX_RSCHED_TIME = timeout [wait_time]</span></div><div class="p"><dl class="dl parml"><div class="dlentry plentry"><dt class="dt pt">timeout </dt><dd class="dd pd"><div class="p">timeout*<span class="keyword parmname display-inline">MBD_SLEEP_TIME</span> determines how long a job stays pending in the execution cluster before returning to the submission cluster.</div><div class="p"> The timeout value can be customized based on average job runtime and <span class="keyword parmname display-inline">XL_RES_RATIO</span> for the cluster. For example:</div><div class="p">timeout = MAX(job_runtime, (<span class="keyword parmname display-inline">XL_RES_RATIO</span> - 1) * job_runtime) * 2 / <span class="keyword parmname display-inline">MBD_SLEEP_TIME</span></div></dd></div><div class="dlentry plentry"><dt class="dt pt">wait time</dt><dd class="dd pd"><div class="p">wait_time*<span class="keyword parmname display-inline">MBD_SLEEP_TIME</span> determines how long the submission cluster waits for other execution clusters to become available before returning to the same execution cluster. The wait time only applies when there are execution clusters the job has not yet tried.</div></dd></div></dl></div></body></html>